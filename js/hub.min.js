var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(b){return b.raw=b};$jscomp.createTemplateTagFirstArgWithRaw=function(b,a){b.raw=a;return b};$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(a.call(c,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){if(b==Array.prototype||b==Object.prototype)return b;b[a]=c.value;return b};
$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var a=0;a<b.length;++a){var c=b[a];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,a){var c=$jscomp.propertyToPolyfillSymbol[a];if(null==c)return b[a];c=b[c];return void 0!==c?c:b[a]};$jscomp.polyfill=function(b,a,c,d){a&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,a,c,d):$jscomp.polyfillUnisolated(b,a,c,d))};
$jscomp.polyfillUnisolated=function(b,a,c,d){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];if(!(e in c))return;c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})};
$jscomp.polyfillIsolated=function(b,a,c,d){var e=b.split(".");b=1===e.length;d=e[0];d=!b&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;a=a(c);null!=a&&(b?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:a}):a!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:a})))};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
(function(b){b.storage=new b.store;b.hub={lang:!1,framework_version:!1,options:{accountName:""},deleteDialog:{},init:function(a){this.options=a||{};this.waLoading=b.waLoading();this.topics_count=parseInt(this.options.topics_count.all);b.sidebar.init({reloadTime:3E5});this.$window=b(window);this.$body=b("body");this.$content=b("#content");this.$addTopicButtonMobile=b(".js-add-topic-mobile");this.loadedEvent=b.Event("wa_loaded");this.$window.on("wa_loaded.pulsar",b.proxy(this.setPulsar,this));this.toggleAddTopicButton();
"undefined"!=typeof b.History&&(b.History.bind(b.hub.dispatch),b.History.unbind=function(c,d){d?b.History.handlers.specific[c]&&b.each(b.History.handlers.specific[c],function(e,f){if(f===d)return b.History.handlers.specific[c].splice(e,1),!1}):(d=c,b.each(b.History.handlers.generic,function(e,f){if(f===d)return b.History.handlers.generic.splice(e,1),!1}))});a=window.location.hash;"#/"!==a&&a||this.dispatch()},forceHash:function(a){a=b.hub.helper.cleanHash(a);b.hub.currentHash!==a&&(b.hub.currentHash=
a,b.wa.setHash(a))},backWithoutDispatch:function(a){var c;a&&b.History.bind(c=function(){b.History.unbind(c);a()});this.skipDispatch=1;history.back()},redispatch:function(){this.currentHash=null;this.dispatch()},skipDispatch:0,currentHash:null,dispatch:function(a){if(this!==b.hub)return b.hub.dispatch(a);if(0<b.hub.skipDispatch)return b.hub.skipDispatch--,!1;a=b.hub.helper.cleanHash(a||void 0);if(b.hub.currentHash!=a){var c=b.hub.currentHash;b.hub.currentHash=a;var d=new b.Event("wa_before_dispatched");
this.$window.trigger(d);if(d.isDefaultPrevented())return b.hub.currentHash=c,b.wa.setHash(c),!1;this.removeSettingsClass();if(a)if(a=a.replace(/^.*#\/?/,"").replace(/\/$/,""),a=a.split("/"),a[0]){c="";d=a.length;for(var e=0;e<a.length;e++){var f=a[e];if(2>e)if(0===e)c=f;else if("add"==f||parseInt(f,10)!=f&&-1==f.indexOf("=")&&"search"!==c&&"following"!==c&&"plugins"!==c)c+=f.substr(0,1).toUpperCase()+f.substr(1);else{d=e;break}else{d=e;break}}a=a.slice(d);b.hub[c+"Action"]?(b.sidebar.highlight(),
b.hub.currentAction=c,b.hub.currentActionAttr=a,b.hub[c+"Action"].apply(b.hub,a),this.$body.animate({scrollTop:0},200)):console&&console.log("Invalid action name:",c+"Action")}else b.hub.defaultAction();else b.hub.defaultAction()}},defaultAction:function(a){this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);b.sidebar.sidebar.find("li.selected").removeClass("selected");b.sidebar.sidebar.find('a[href="#/"]').parent().addClass("selected");a=this.getOrder("default",a);this.load("?module=topics"+
(a?"&sort="+a:""));this.options.addTopicSettings.showAddTopicButton=!0},pluginsAction:function(a){this.loaded||(b(".js-skeleton-plugins").show(),this.loaded=!0);b("#wa-plugins-container").length?b.plugins.dispatch(a):this.load("?module=plugins");this.options.addTopicSettings.showAddTopicButton=!1},getOrder:function(a,c){a="hub/"+a+"/order";return c?(b.storage.set(a,c),c):b.storage.get(a)},initLazyLoad:function(){var a=this,c=b(".lazyloading-paging");if(c.length){var d=parseInt(c.data("times")||"10",
10),e=c.data("linkText")||"Load more",f=c.find("li.selected");"1"==f.children("a").text()&&(c.hide(),a.$window.lazyLoad("stop"),f.next().length&&a.$window.lazyLoad({container:"#h-content .h-topics",load:function(){a.$window.lazyLoad("sleep");var g=b(".lazyloading-paging").hide(),h=b(".h-footer"),k=g.find("li.selected").next().find("a").attr("href");if(k){var m=b("#h-content .h-topics");b(".loading-wrapper").show();b.get(k,function(l){l=b("<div></div>").html(l);m.append(l.find("#h-content .h-topics").children());
var q=l.find(".lazyloading-paging").hide();g.replaceWith(q);g=q;h.replaceWith(l.find(".h-footer"));--d;if(g.find("li.selected").next().length)if(!isNaN(d)&&0>=d)if(a.$window.lazyLoad("sleep"),b(".lazyloading-load-more").length)b(".lazyloading-load-more").show();else b('<a href="#" class="semibold custom-ml-4 lazyloading-load-more">'+e+"</a>").insertAfter(b(".loading-wrapper")).on("click",function(r){r.preventDefault();b(this).hide();d=1;a.$window.lazyLoad("wake");a.$window.lazyLoad("force")});else a.$window.lazyLoad("wake");
else a.$window.lazyLoad("stop"),b(".lazyloading-load-more").remove();l.remove();m.trigger("lazyload_append");b(".loading-wrapper").hide()})}else a.$window.lazyLoad("stop")}}))}},popularAction:function(){this.defaultAction("popular")},archiveAction:function(){this.defaultAction("archive")},updatedAction:function(){this.defaultAction("updated")},recentAction:function(){this.defaultAction("recent")},unansweredAction:function(){this.defaultAction("unanswered")},contactAction:function(a,c,d){(d=d||"")&&
(d="&sort="+d);(c=c||"")&&(c="&hub_id="+c);this.load("?module=topics"+d+c+"&hash=contact/"+encodeURIComponent(a),function(){b(".js-sort-menu").remove()})},load:function(a,c){var d=this,e=b.hub.load_protector=Math.random();d.waLoading.animate(2E3,96,!1);d.$content.removeClass("flexbox");b.get(a,{},function(f){if(e===b.hub.load_protector){d.$window.scrollTop(0);d.$content.html(f);d.waLoading.done();f=d.$content.find(".js-page-title:first");f.length&&(f=f.text(),document.title=f+" \u2014 "+d.options.accountName);
if(c)try{c.call(this)}catch(g){}d.$window.trigger(d.loadedEvent);d.$body.find(".rx-popup").hide()}})},typeAction:function(a,c){this.load("?module=topics&hash=type/"+a+(c?"&sort="+c:""))},hubAction:function(a,c){this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);c=this.getOrder("hub"+a,c);this.load("?module=topics&hash=hub/"+a+(c?"&sort="+c:""));this.options.addTopicSettings.showAddTopicButton=!0},followingAction:function(a){this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);
a=this.getOrder("following",a);this.load("?module=topics&hash=following"+(a?"&sort="+a:""));this.options.addTopicSettings.showAddTopicButton=!0},categoryAddAction:function(a){var c=this;this.loaded||(b(".js-skeleton-category-add").show(),this.loaded=!0);a=parseInt(a);this.load("?module=settings&action=category&hub_id="+a,function(){c.streamSettingsHandler(null,null,"category")});this.options.addTopicSettings.showAddTopicButton=!1},categoryAction:function(a,c,d){var e=this;this.loaded||(b(".js-skeleton-default").show(),
this.loaded=!0);this.load("?module=topics&hash=category/"+a+(c?"&sort="+c:""),function(){d&&"function"==typeof d&&d();e.$content.on("click","a.stream-edit",function(f){f.preventDefault();var g=b(this);g.find(".fa-pen").removeClass("fa-pen").addClass("fa-spinner fa-spin");e.$content.find("#h-stream-settings").load("?module=settings&action=category&id="+a,function(){e.streamSettingsHandler(a,g,"category")})})});this.options.addTopicSettings.showAddTopicButton=!0},filterAddAction:function(){var a=this;
this.loaded||(b(".js-skeleton-filter-add").show(),this.loaded=!0);this.load("?module=settings&action=filter",function(){a.streamSettingsHandler(null,null,"filter")});this.options.addTopicSettings.showAddTopicButton=!1},filterAction:function(a,c,d){var e=this;this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);c=this.getOrder("filter"+a,c);this.load("?module=topics&hash=filter/"+a+(c?"&sort="+c:""),function(){d&&"function"==typeof d&&d();e.$content.on("click","a.stream-edit",function(f){f.preventDefault();
var g=b(this).data("filter-id"),h=b(this);h.find(".fa-pen").removeClass("fa-pen").addClass("fa-spinner fa-spin");e.$content.find("#h-stream-settings").load("?module=settings&action=filter&id="+g,function(){e.streamSettingsHandler(g,h,"filter")})})});this.options.addTopicSettings.showAddTopicButton=!0},tagAction:function(a,c){this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);this.load("?module=topics&hash=tag/"+a+(c?"&sort="+c:""));this.options.addTopicSettings.showAddTopicButton=!0},
searchAction:function(a){this.loaded||(b(".js-skeleton-default").show(),this.loaded=!0);this.load("?module=topics&hash=search/"+encodeURIComponent(a));this.options.addTopicSettings.showAddTopicButton=!0},topicAddAction:function(){this.loaded||(b(".js-skeleton-topic-edit").show(),this.loaded=!0);this.load("?module=topics&action=edit");this.options.addTopicSettings.showAddTopicButton=!1},topicEditAction:function(a){this.loaded||(b(".js-skeleton-topic-edit").show(),this.loaded=!0);this.load("?module=topics&action=edit&id="+
a);this.options.addTopicSettings.showAddTopicButton=!0},topicAction:function(a){this.loaded||(b(".js-skeleton-topic-edit").show(),this.loaded=!0);this.load("?module=topics&action=info&id="+a);this.options.addTopicSettings.showAddTopicButton=!0},settingsAction:function(){this.loaded||(b(".js-skeleton-settings").show(),this.loaded=!0);this.load("?module=settings");this.options.addTopicSettings.showAddTopicButton=!1},authorsAction:function(){this.loaded||(b(".js-skeleton-authors").show(),this.loaded=
!0);this.load("?module=authors");this.options.addTopicSettings.showAddTopicButton=!0},settingsTypeAction:function(a){this.loaded||(b(".js-skeleton-settings-type").show(),this.loaded=!0);this.load("?module=settings&action=type&id="+a);this.options.addTopicSettings.showAddTopicButton=!1},settingsHubAction:function(a){this.loaded||(b(".js-skeleton-settings-hub").show(),this.loaded=!0);this.load("?module=settings&action=hub&id="+a);this.options.addTopicSettings.showAddTopicButton=!1},settingsFilterAction:function(a){this.load("?module=settings&action=filter&id="+
a);this.options.addTopicSettings.showAddTopicButton=!1},commentsAction:function(a){this.loaded||(b(".js-skeleton-comments").show(),this.loaded=!0);this.load("?module=comments"+(a?"&"+a:""));this.options.addTopicSettings.showAddTopicButton=!0},pagesAction:function(a){var c=this;this.loaded||(b(".js-skeleton-pages").show(),this.loaded=!0);b("#wa-page-container").length?(waLoadPage(a),this.$content.addClass("flexbox")):this.load("?module=pages",function(){c.$content.addClass("flexbox")});this.options.addTopicSettings.showAddTopicButton=
!1},designAction:function(a){this.loaded||(b(".js-skeleton-pages").show(),this.loaded=!0);b("#wa-design-container").length?waDesignLoad():this.load("?module=design",function(){a?waDesignLoad(a):waDesignLoad()});this.$window.trigger(this.loadedEvent);this.options.addTopicSettings.showAddTopicButton=!1},designThemesAction:function(a){this.loaded||(b(".js-skeleton-pages").show(),this.loaded=!0);b("#wa-design-container").length?waDesignLoad():this.load("?module=design",function(){waDesignLoad()});this.$window.trigger(this.loadedEvent);
this.options.addTopicSettings.showAddTopicButton=!1},setPulsar:function(){var a=this;if(!b.sidebar.$addTopicButton.length||this.topics_count||localStorage.getItem("wa_hub_pulsar"))this.unsetPulsar();else{var c=!!b.sidebar.sidebarData;this.$pulsar||c||(this.$pulsar=b.sidebar.$addTopicButton.clone().appendTo("body"));this.$pulsar&&c&&this.$pulsar.remove();var d=function(){if(a.$pulsar){var e=b.sidebar.$addTopicButton.offset();a.$pulsar.css({top:e.top,left:e.left})}};c?(b.sidebar.$addTopicButton.addClass("pulsar"),
this.$addTopicButtonMobile.addClass("pulsar")):(this.$pulsar.addClass("pulsar").css({position:"fixed","pointer-events":"none"}),d());b.sidebar.$addTopicButton.on("click.pulsar",b.proxy(this.unsetPulsar,this));this.$addTopicButtonMobile.on("click.pulsar",b.proxy(this.unsetPulsar,this));this.$window.on("resize.pulsar",b.proxy(this.setPulsar,this));this.$window.on("wa_sidebar_loaded.pulsar",d)}},unsetPulsar:function(){this.$pulsar&&this.$pulsar.remove();b.sidebar.$addTopicButton.removeClass("pulsar");
this.$addTopicButtonMobile.removeClass("pulsar");b.sidebar.$addTopicButton.off(".pulsar");this.$addTopicButtonMobile.off(".pulsar");this.$window.off(".pulsar");localStorage.setItem("wa_hub_pulsar","1")},toggleAddTopicButton:function(){var a=this;this.options.addTopicSettings=new Proxy({},{set:function(c,d,e){if("showAddTopicButton"===d){if(e)return a.$addTopicButtonMobile.removeClass("hidden"),!0;a.$addTopicButtonMobile.addClass("hidden");return!1}}})},streamSettingsSaveHandler:function(a,c,d,e,f,
g){this.options.addTopicSettings.showAddTopicButton=!0;var h=d.find(":submit");h.prop("disabled",!1);h.siblings(".spinner").remove();this.removeSettingsClass();window.scrollTo(0,0);if("ok"!==a.status)b.hub.helper.formError(d,a.errors||{},"category");else if(c.hide(),g&&(g.find(".fa-spinner").removeClass("loading fa-spinner fa-spin").addClass("fa-pen"),g.show()),a.data){c=a.data||{};switch(f){case "category":b.hub.helper.updateCategory(e||c.id,c);break;case "filter":b.hub.helper.updateFilter(e||c.id,
c)}if(e)switch(d=function(){b(".h-saved").show();setTimeout(function(){b(".h-saved").hide()},4E3)},f){case "category":0<c.type?b.hub.categoryAction(e,null,d):(document.title=a.data.name+" \u2014 "+b.hub.options.accountName,d());break;case "filter":b.hub.filterAction(e,null,d)}else window.location.hash="/"+f+"/"+c.id+"/"}},streamDeleteHandler:function(a,c,d){var e=this;d?"string"==typeof d&&(d+="&id="+a):d={id:a};b.post("?module=settings&action="+c+"Delete",d,function(f){if("ok"==f.status){switch(c){case "category":b.sidebar.sidebar.find("#category-"+
a).remove();e.deleteDialog[a]&&(e.deleteDialog[a].close(),delete e.deleteDialog[a]);break;case "filter":b.sidebar.sidebar.find('a[href="\\#/filter/'+a+'/"]').closest("li").remove()}window.location.hash="#/";b.sidebar.resetHub()}},"json")},streamSettingsHandler:function(a,c,d){var e=this;this.options.addTopicSettings.showAddTopicButton=!1;c&&c.hide();var f=b("#h-stream-settings");f.fadeIn(200);this.$content.addClass("settings-active");var g=this,h=f.find("form");this.helper.glyphHandler(h,d,"filter"==
d?"icon":"glyph");h.find(':input[name$="\\[name\\]"]:first').focus();h.find('textarea[name="category[description]"]').length&&b.hub.callRedactor(h.find('textarea[name="category[description]"]'),{uploadPath:"?module=pages&action=uploadimage&r=x&absolute=1",csrf:h.find('input[name="_csrf"]').val()});h.on("submit",function(k){k.preventDefault();b.hub.helper.formError(h);k=new FormData(this);var m=b('<i class="fas fa-spinner fa-spin custom-ml-4"></i>'),l=h.find("#h-category-logo-progressbar"),q=l.find(".progressbar-inner"),
r=l.find(".progressbar-text");l.show();h.find(":submit").attr("disabled",!0).append(m);b.ajax({url:h.attr("action"),type:"POST",async:!0,xhr:function(){var p=b.ajaxSettings.xhr();p.upload&&h.find(':input[type="file"]').length&&p.upload.addEventListener("progress",function(n){n.lengthComputable&&(n=Math.min(100,Math.floor((n.loaded||n.position)/(n.totalSize||n.total)*100)),q.css("width",n+"%"),r.text(n+"%"))},!1);return p},success:function(p){try{h.find(".progressbar").hide();var n=b.parseJSON(p);
g.streamSettingsSaveHandler(n,f,h,a,d,c||!1)}catch(t){b.hub.helper.formError(h,{submit:p.replace(/<\/?[^>]+>/gi,"").substr(0,512)},"category")}},data:k,cache:!1,dataType:"html",contentType:!1,processData:!1})});b(".cancel",f).on("click",function(k){k.preventDefault();f.hide();g.removeSettingsClass();window.scrollTo(0,0);c?(c.find(".fa-spinner").removeClass("fa-spinner fa-spin").addClass("fa-pen"),c.show()):window.location.hash="/";e.options.addTopicSettings.showAddTopicButton=!0});a&&(b(".js-delete",
f).on("click",function(k){k.preventDefault();k=b(this);"category"==d&&k.hasClass("js-dialog")&&(g.deleteDialog[a]?g.deleteDialog[a].show():g.deleteDialog[a]=b.waDialog({$wrapper:b("#h-category-delete"),onClose:function(m){m.hide();return!1}}))}),b(".js-hub-remove-category").on("click",function(k){k.preventDefault();b(this).attr("disabled",!0);k=b('<i class="fas fa-spinner fa-spin custom-ml-4"></i>');b(this).append(k);g.streamDeleteHandler(a,d,g.deleteDialog[a].$body.find("form").serialize())}))},
removeSettingsClass:function(){this.$content.removeClass("settings-active")},callRedactor:function(a,c){return RedactorX(a,{editor:{minHeight:"64px",lang:b.hub.lang||"en"},context:!0,image:{upload:c.uploadPath,data:{_csrf:c.csrf}},toolbar:{sticky:!1},topbar:!1,buttons:{addbar:["paragraph","image","embed","quote","pre"],context:["bold","italic","deleted","link","pre"],topbar:["undo","redo"]},format:["p","ul","ol"],quote:{template:'<blockquote data-placeholder="'+(b.wa.locale.blockquote||"Quote...")+
'"></blockquote>'},shortcutsRemove:["ctrl+h, ctrl+l, ctrl+alt+1, ctrl+alt+2, ctrl+alt+3, ctrl+alt+4, ctrl+alt+5, ctrl+alt+6"]})},manageHandler:function(a,c){b("#blog-stream-primary-menu").hide();b("#blog-stream-manage-menu").show();this.management=!0;this.onContentUpdate();return!1},manageCompleteHandler:function(a,c){this.management=!1;b("#blog-stream-manage-menu").hide();b("#blog-stream-primary-menu").show();b(".b-post.js-managed").each(function(){b(this).removeClass("js-managed");b(this).find("h3:hidden").show();
b(this).find("h3:first").hide();b(this).find(".b-post-body:hidden, .profile.image20px:hidden").fadeIn()});return!1},topics:{last_hash:"",$topics_ul:null,$bulk_menu:null,$sort_menu:null,init:function(a){this.last_hash=window.location.hash;if(a&&"undefined"!=typeof a.topics_count){var c=b("#wa-app > .sidebar li.selected:first .count:first");c.length&&c.text(a.topics_count)}this.$topics_ul=b(".h-topics");this.initBulkActions();this.initFollowLinks();this.initRatingBox();this.initTopicTypesFilter();this.$topics_ul.on("click",
".toggle-comments",function(){b(this).closest(".h-topic").find(".js-topic-comments").slideToggle(200)});this.$topics_ul.on("click",".js-topic-comments-all",function(){b(this).closest(".js-topic-comments").find(".h-comment").removeClass("hidden");b(this).remove()});b(".h-saved .h-close-saved").on("click",function(d){d.preventDefault();b(this).closest(".h-saved").fadeOut(200)})},initBulkActions:function(){function a(f,g,h){if(f&&g&&f[0]&&g[0]&&!f.is(g[0])){var k=!1;g.closest(".h-topics").find("> li").each(function(m,
l){if(k){if(f.is(l)||g.is(l))return!1;b(l).find("input:checkbox.js-bulk-mode").prop("checked",h).change()}else if(f.is(l)||g.is(l))k=!0})}}var c=this;c.$topics_header=b(".js-topics-header");c.$bulk_menu_toggle=c.$topics_header.find(".js-bulk-toggle");c.$bulk_menu=c.$topics_header.find("#bulk-menu");c.$sort_menu=c.$topics_header.find(".js-sort-menu:first");c.$bulk_menu_priority=c.$topics_header.find("#bulk-menu-priority");c.$bulk_menu_priority.waDropdown({update_title:!1});c.$sort_menu.waDropdown();
this.$bulk_menu_toggle.on("click",function(f){f.preventDefault();c.$topics_ul.toggleClass("h-bulk-mode");c.$topics_header.toggleClass("active");c.$bulk_menu.is(":visible")&&c.bulkCount()});this.$bulk_menu.find(".js-bulk-action").on("click",function(f){f.preventDefault();f=b(this);if(c.bulkCount()){var g=f.data("action");g="bulk"+g.substr(0,1).toUpperCase()+g.substr(1);c[g+"Action"].apply(c,[f])}else b.waDialog.alert({title:$_("Select at least one topic"),button_title:$_("Close"),button_class:"warning"})});
this.$topics_ul.on("change",":input.js-bulk-mode",function(){c.bulkCount()});var d=null,e=null;this.$topics_ul.on("click",":input.js-bulk-mode",function(f){var g=b(this),h=g.closest(".h-topic");g.prop("checked")?(f.shiftKey&&d&&a(d,h,!0),d=h,e=null):(f.shiftKey&&e&&a(e,h,!1),d=null,e=h);c.bulkCount()});b.storage.get("sort-handler-unavailable-notice-hidden")?b(".sort-handler-unavailable-notice").remove():(b(".sort-handler-unavailable-notice").removeClass("hidden"),b(".sort-handler-unavailable-notice .h-close").on("click",
function(f){f.preventDefault();b(this).closest(".sort-handler-unavailable-notice").remove();b.storage.set("sort-handler-unavailable-notice-hidden",!0)}))},initFollowLinks:function(){var a=b(".js-follow-topic").closest(".h-topic-meta"),c=b("#following-count"),d=a.find(".followers-count"),e=a.find(".following-status"),f=a.find(".own-follower-icon");b(document).on("click",".js-follow-topic",function(g){g.preventDefault();g=b(this);var h=g.find(".fa-star"),k="far"===h.data("prefix")?1:0,m=parseInt(b("#following-count").html());
k?(h.attr("data-prefix","fas"),h.removeClass("gray").addClass("text-yellow"),e.text(b.wa.locale.following).removeClass("text-gray"),f.show(),m+=1):(h.attr("data-prefix","far"),h.removeClass("text-yellow").addClass("gray"),e.text(b.wa.locale.not_following).addClass("text-gray"),f.hide(),--m);c.addClass("highlighted").html(m);b.post("?module=following",{topic_id:g.data("topic"),follow:k},function(l){"ok"!==l.status?console.warn(l):d.text(l.data.followers)},"json")})},initRatingBox:function(){var a=
b(".js-rating-box"),c=a.find(".total-score"),d=b(".js-rating-count-up"),e=b(".js-rating-count-down");a.on("click","a",function(f){f.preventDefault();var g=b(this),h=b(this).hasClass("h-vote-down")?-1:1;f=b(this).data("topic-id");b.post("?module=frontend&action=vote",{id:f,type:"topic",vote:h},void 0,"json").always(function(k,m){if("success"===m||k||k.data||k.data.hasOwnProperty("votes_sum")){m=g.parent().find(".up,.up-bw");var l=g.parent().find(".down,.down-bw");0<h?(m.removeClass("up-bw").addClass("up"),
l.removeClass("down").addClass("down-bw")):(m.addClass("up-bw").removeClass("up"),l.addClass("down").removeClass("down-bw"));c.removeClass("text-green text-red text-gray");c.text(k.data.votes_sum);d.text(k.data.votes_up);e.text(-1*k.data.votes_down);0<k.data.votes_sum-0?(c.addClass("text-green"),c.text("+"+k.data.votes_sum)):0>k.data.votes_sum-0?c.addClass("text-red"):c.addClass("text-gray")}})})},initTopicTypesFilter:function(){function a(){var h={};f.map(function(){if(this.checked)return 1;h[this.value]=
1}).length||(h={});var k=[],m=[];d.children().each(function(){var l=b(this).data("type-id");h[l]?k.push(this):m.push(this)});k.length?(b(k).css("opacity",.7).slideUp(function(){b(k).css("opacity","");g.scroll()}),b(".h-footer .place-for-hidden-label").show().children("span").text(k.length),d.closest(".h-stream").addClass("h-js-filtered").removeClass("h-not-js-filtered")):(b(".h-footer .place-for-hidden-label").hide().children("span").text("0"),d.closest(".h-stream").addClass("h-not-js-filtered").removeClass("h-js-filtered"));
m.length&&b(m).slideDown(function(){g.scroll()})}function c(){var h=f.map(function(){return(this.checked||null)&&b.trim(b(this).closest("label").text())}).get().join(", ");h=b.trim(e.find("ul li.selected a").text())+(h?": "+h:"");e.find(".js-filter-name").text(h)}var d=b("#h-content .h-topics"),e=b(".h-sort.js-sort-menu"),f=e.find(".h-filter-by-type :checkbox"),g=b(window);e.find(".h-filter-by-type").on("change",":checkbox",function(){a();c()});d.on("lazyload_append",function(){a()})},initManualDragAndDrop:function(a){this.$topics_ul.sortable({handle:".sort,h3 a,i.h-glyph32",
onUpdate:function(c){var d=b(c.item).data("id");c=b(c.item).next("li").data("id");b.post("?module=topics&action=move",{id:d,before_id:c,category_id:a},null,"json").always(function(e,f){("success"!==f||"ok"!==e.status)&&console&&console.log(f,e.errors||e)})}})},bulkCount:function(){var a=this.$topics_ul.find(":input.js-bulk-mode:checked").length;this.$topics_header.find(".js-count").text(a);return a},bulkDeleteAction:function(a){var c=this;a=a.data("confirm");b.waDialog.confirm({title:a,success_button_title:$_("Delete"),
success_button_class:"danger",cancel_button_title:$_("Close"),cancel_button_class:"light-gray",onSuccess:function(){var d=[];c.$topics_ul.find(":input.js-bulk-mode:checked").each(function(){d.push(this.value)});b.ajax({url:"?module=topics&action=delete",dataType:"json",type:"post",data:{ids:d},success:function(e){c.$bulk_menu.find(".js-close-bulk-menu").click();if("ok"!==e.status)console.warn(e);else if(e.data.deleted){for(var f in e.data.deleted)e.data.deleted.hasOwnProperty(f)&&c.$topics_ul.find('[data-id="'+
e.data.deleted[f]+'"]').remove();b.hub.topics.bulkCount();b.sidebar.reload()}}})}})},bulkPriorityAction:function(a){a=a.data("priority");var c=this.$topics_ul.find(":input.js-bulk-mode:checked").map(function(){return this.value}).get();b.post("?module=topics&action=bulkPriority",{priority:a,topic_ids:c},function(){b.hub.redispatch()})},bulkMoveAction:function(a){a="&hub_id="+a.data("hub")+"&category_id="+a.data("category");var c=b("#h-bulk-topics-move"),d=this;d.bulMoveDialog?d.bulkMoveDialog():c.load("?module=dialog&action=topicsMove"+
a,function(){c.find(':input[name="hub_id"]').on("change",function(){if(this.checked){c.find("select").attr("disabled",!0).closest(".js-move-dialog-select").addClass("hidden");var e=b(this).closest(".js-move-dialog-section").find("select:first");e.length&&(e.attr("disabled",null),e.closest(".js-move-dialog-select").removeClass("hidden"))}});d.bulkMoveDialog(c)})},bulkMoveDialog:function(a){var c=this;a?(c.bulMoveDialog=b.waDialog({html:a,onOpen:function(d){var e=[];c.$topics_ul.find(":input.js-bulk-mode:checked").each(function(){e.push(this.value)});
d.find(':input[name="topic_ids"]').val(e.join(","))},onClose:function(d){d.hide();return!1}}),c.bulMoveDialog.$block.find(".js-move-dialog-save").on("click",function(d){d.preventDefault();d=c.bulMoveDialog.$block.find("form:first");var e=d.find(':input[name="hub_id"]:checked'),f=e.val(),g=e.closest(".js-move-dialog-section").find("select:first").val(),h=b(this),k=b('<i class="fas fa-spinner fa-spin custom-ml-4"></i>');h.attr("disabled",!0);h.append(k);b.ajax({url:d.attr("action"),data:d.serialize(),
dataType:"json",type:"post",success:function(m){h.attr("disabled",!1);k.remove();c.bulMoveDialog.hide();window.location.hash=g?"/category/"+g+"/":f?"/hub/"+f+"/":"/"}})})):c.bulMoveDialog.show()}},helper:{formError:function(a,c,d){a.find(":submit").attr("disabled",null);if(c){for(var e in c||{})if(c.hasOwnProperty(e)){var f=a.find(this.getSelector(e,d));f.length||(f=a.find(this.getSelector(e)));f.length||(f=a.find(":submit:first"));f.addClass("error");var g=f.next(".errormsg");g.length?g.text(c[e]):
f.after(b('<em class="errormsg"></em>').text(c[e]))}a.find("input.error:first").focus()}else a.find(":input.error").removeClass("error"),a.find(".errormsg").text("")},updateCategory:function(a,c){a=b.sidebar.sidebar.find("#category-"+a);a.length?(a.find(".name").text(c.name),a.find(".count").text(c.topics_count),a.find(".js-glyph").replaceWith(c.glyph_html),b("h1.list-title .title").text(c.name)):b.sidebar.reload(function(){b.sidebar.setHub(c.hub_id)})},updateFilter:function(a,c){var d=b.sidebar.sidebar.find('a[href="\\#/filter/'+
a+'/"]').parents("li");if(d.length)d.find(".name").text(c.name),d.find(".icon").replaceWith(c.icon_html);else{switch(c.icon){case "funnel":c.icon="filter";break;case "lightning":c.icon="bolt";break;case "light-bulb":c.icon="lightbulb";break;case "lock-unlocked":c.icon="lock-open";break;case "contact":c.icon="user-friends";break;case "reports":c.icon="chart-line";break;case "books":c.icon="book";break;case "marker":c.icon="map-marker-alt";break;case "lens":c.icon="camera";break;case "alarm-clock":c.icon=
"clock";break;case "notebook":c.icon="sticky-note";break;case "blog":c.icon="file-alt";break;case "disk":c.icon="save";break;case "burn":c.icon="radiation-alt";break;case "clapperboard":c.icon="video";break;case "cup":c.icon="mug-hot";break;case "smiley":c.icon="smile";break;case "target":c.icon="bullseye"}d=b('<li id="filter-'+(a||c.id)+'" data-filter-id="'+(a||c.id)+'">\n                        <a href="#/filter/'+(a||c.id)+'/">\n                            <span class="icon"><i class="fas fa-'+
c.icon+'"></i></span>\n                            <span class="name">'+c.name+"</span>\n                        </a>\n                        </li>");b(".js-sidebar-filters").append(d)}},glyphHandler:function(a,c,d){d||(d="glyph");var e=a.find(".js-"+d+"-templates"),f=a.find(this.getSelector(d,c));e.on("click","li > a",function(g){g.preventDefault();e.find(".selected").removeClass("selected");g=b(this);g.parents("li").addClass("selected");f.val(g.data(d))})},confirmLeave:function(a,c,d){var e,f,
g=b(window);g.on("beforeunload",e=function(h){if(a())return c});g.on("wa_before_dispatched",f=function(h){a()?confirm(c+" "+d)||h.preventDefault():g.off("unload",e).off("wa_before_dispatched",f)})},cleanHash:function(a){"undefined"==typeof a&&(a=window.location.hash.toString());for(a.length||(a=""+a);0<a.length&&"/"===a[a.length-1];)a=a.substr(0,a.length-1);a+="/";"#"!=a[0]?("/"!=a[0]&&(a="/"+a),a="#"+a):a[1]&&"/"!=a[1]&&(a="#/"+a.substr(1));if("#/"==a)return"";try{a=decodeURIComponent(a)}catch(c){}return a},
isCtrlS:function(a){return 19==a.which||115==a.which&&a.ctrlKey||"s"==String.fromCharCode(a.which).toLowerCase()&&a.ctrlKey?!0:!1},getSelector:function(a,c){var d=':input[name="';return c?d+c+"\\["+a+'\\]"]':d+a+'"]'}}}})(jQuery);(function(b){b.sidebar={sidebar:null,options:{},init:function(a){this.options=a||{};this.sidebar=b("#wa").find(".js-app-sidebar:first");this.$window=b(window);this.$skeleton=this.sidebar.find(".js-hub-sidebar-skeleton");this.$sidebarBody=this.sidebar.find(".js-hub-sidebar-body");this.$sidebarBg=this.sidebar.find("#hub-sidebar-bg");this.$addTopicButton=this.sidebar.find(".js-add-topic");this.$hubList=this.sidebar.find(".h-hub");this.$hubsAll=this.sidebar.find("#hub-all");this.$hubSelector=this.sidebar.find(".js-hub-selector");
this.$hubSelectorBack=this.sidebar.find(".js-hub-selector-back");this.$filters=this.sidebar.find(".js-sidebar-filters");this.$categories=this.sidebar.find(".js-categories-sort");this.loadedEvent=b.Event("wa_sidebar_loaded");this.hubLoadedEvent=b.Event("wa_sidebar_hub_loaded");this.hubUnLoadedEvent=b.Event("wa_sidebar_hub_unloaded");this.reloader||this.setIntervalReloader();this.bindEvents();this.$window.trigger(this.loadedEvent);this.initDragAndDrop();this.highlight();this.iterateCollapsibleSidebar()},
bindEvents:function(){this.$window.on("wa_sidebar_loaded.Hub",b.proxy(this.initMobileSidebar,this));this.$window.on("resize.Hub",b.proxy(this.initMobileSidebar,this));this.$hubSelector.on("click.Hub",b.proxy(this.showHub,this));this.$hubSelectorBack.on("click.Hub",b.proxy(this.resetHub,this));this.sidebar.on("click.Hub",".js-collapse-block",b.proxy(this.collapseBlock,this));this.$window.on("resize.Hub",b.proxy(this.initDragAndDrop,this));this.$window.on("wa_loaded.Hub",b.proxy(this.removeSkeleton,
this));this.sidebar.on("click.Hub",".menu li a, .js-mobile-collapse-sidebar",b.proxy(this.slideUpSidebar,this))},initDragAndDrop:function(){768<this.$window.width()&&(this.initCategoriesDragAndDrop(),this.initFiltersDragAndDrop())},initMobileSidebar:function(){768<this.$window.width()?this.sidebarData&&(this.sidebar.removeData("sidebar"),this.sidebarData.unbindEvents(),delete this.sidebarData):this.sidebarData||(this.sidebar.waShowSidebar(),this.sidebarData=this.sidebar.data("sidebar"))},slideUpSidebar:function(){this.sidebarData&&
(this.sidebarData.$sidebar_content.slideUp(200),this.sidebarData.is_open=!1)},setIntervalReloader:function(){var a=this;this.reloader=setInterval(function(){a.reload({},!0)},this.options.reloadTime||3E5)},clearIntervalReloader:function(){clearInterval(this.reloader)},removeSkeleton:function(){this.$sidebarBody.removeClass("hidden");this.$skeleton.addClass("hidden")},setHub:function(a){a=this.$sidebarBody.find('.js-hub-selector[data-hub-id="'+a+'"]');a.addClass("prevent-hash-change");a.click()},showHub:function(a){a.preventDefault();
this.sidebarData&&this.slideUpSidebar();a=b(a.target).closest(".js-hub-selector");var c=a.data("hub-id"),d=a.data("hub-color"),e=a.data("href");c=this.sidebar.find("#hub-"+c);this.$hubList.removeClass("active");c.addClass("active");this.$sidebarBg.addClass("h-"+d);this.$sidebarBody.addClass("active");this.$sidebarBody[0].scrollTo(0,0);d!==this.cacheColor&&this.$addTopicButton.length&&this.$addTopicButton.removeClass("h-hub-color-"+this.cacheColor);this.cacheColor=d;"white"!==d&&this.$addTopicButton.length&&
this.$addTopicButton.addClass("h-hub-color-"+d);this.$hubsAll.removeClass("active");a.hasClass("prevent-hash-change")||(window.location.hash=e,this.$hubSelector.removeClass("prevent-hash-change"));this.$window.trigger(this.hubLoadedEvent)},resetHub:function(a){a&&a.preventDefault();this.$sidebarBody.removeClass("active");this.$sidebarBg.removeClass("h-"+this.cacheColor);this.$hubList.removeClass("active");this.$addTopicButton.length&&this.$addTopicButton.removeClass("h-hub-color-"+this.cacheColor);
this.$window.trigger(this.hubUnLoadedEvent)},initCategoriesDragAndDrop:function(){this.$categories.sortable({animation:150,direction:"vertical",handle:"> li",onUpdate:function(a){a.oldIndex!==a.newIndex&&(a={id:b(a.item).data("category-id"),before_id:b(a.item).prev().data("category-id")||0},b.post("?module=categories&action=move",a,null,"json").always(function(c,d){("success"!=d||"ok"!==c.status)&&console&&console.log(d,c.errors||c)}))}})},initFiltersDragAndDrop:function(){var a=this;760>a.$window.width()?
a.$filters.sortable("disable"):a.$filters.sortable("enable");var c={};a.$filters.children().each(function(e,f){e=b(f);c[e.data("filter-id")]=e});var d=b.storage.get("hub/filters_order");d&&d.reverse&&b.each(d.reverse(),function(e,f){c[f]&&c[f].prependTo(a.$filters)});a.$filters.sortable({direction:"vertical",handle:"> li",onUpdate:function(e){if(e.oldIndex!==e.newIndex){var f=[];a.$filters.children().each(function(g,h){f.push(b(h).data("filterId"))});b.storage.set("hub/filters_order",f)}}})},collapseBlock:function(a,
c){a&&a.preventDefault();var d=c?b(c):b(a.target).closest(".js-collapse-block");a="hub/"+d.attr("id")+"/collapse";c=d.find(".fa-caret-down");d=d.closest(".js-collapse-block-wrapper").next();c.hasClass("fa-rotate-270")?(c.removeClass("fa-rotate-270"),d.show(),b.storage.del(a,1)):(c.addClass("fa-rotate-270"),d.hide(),b.storage.set(a,1))},iterateCollapsibleSidebar:function(){var a=this;this.sidebar.find(".js-collapse-block").each(function(){var c="hub/"+b(this).attr("id")+"/collapse";b.storage.get(c)&&
a.collapseBlock(null,b(this))})},highlight:function(a){a=b.hub.helper.cleanHash(a);a=a.replace('"','\\"');this.sidebar.find(".selected").removeClass("selected");a.length||this.sidebar.find('a[href="#/"]').parent().addClass("selected");var c=this.sidebar.find('a[href="'+a+'"]');!c.length&&2<a.length&&(c=this.sidebar.find('a[href="'+b.hub.helper.cleanHash(a.replace(/\/[^\/]+\/$/,""))+'"]'));c.length&&c.closest("li").addClass("selected")},reload:function(a,c){var d=this,e="?sidebar=1";c&&(e+="&background_process=1");
b.post(e,function(f){var g=d.$sidebarBody.find(".h-hub.active").data("hub-id");d.unbindEvents();d.sidebar.html(f);d.init();d.$window.trigger("wa_loaded.Hub");g&&b.sidebar.setHub(g);"function"===typeof a&&a()})},unbindEvents:function(){this.sidebar.off(".Hub");this.$hubSelector.off(".Hub");this.$hubSelectorBack.off(".Hub");this.$window.off(".Hub");this.sidebar.removeData("sidebar");delete this.sidebarData;this.clearIntervalReloader()}}})(jQuery);
//# sourceMappingURL=hub.min.js.map